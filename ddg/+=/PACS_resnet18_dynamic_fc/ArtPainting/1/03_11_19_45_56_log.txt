[2024-03-11 19:45:56] [root:185 DEBUG] _________________New log started__________________
[2024-03-11 19:45:56] [root:186 DEBUG] Log config file: /home/sowon_choi/anaconda3/envs/ddg/lib/python3.6/site-packages/logger_tt-1.7.0-py3.6.egg/logger_tt/log_config.json
[2024-03-11 19:45:56] [root:131 DEBUG] Logging queue listener started!
[2024-03-11 19:45:56] [ddg.utils.tools:175 INFO] 
Info(s) in loading state_dict for ResNet:
	Missing key(s) in state_dict: "layer1.0.conv1.conv.weight", "layer1.0.conv1.kernel_templates.conv_nn.weight", "layer1.0.conv1.kernel_templates.conv_11.weight", "layer1.0.conv1.kernel_templates.conv_n1.weight", "layer1.0.conv1.kernel_templates.conv_1n.weight", "layer1.0.conv1.attention.fc1.weight", "layer1.0.conv1.attention.fc2.weight", "layer1.0.conv2.conv.weight", "layer1.0.conv2.kernel_templates.conv_nn.weight", "layer1.0.conv2.kernel_templates.conv_11.weight", "layer1.0.conv2.kernel_templates.conv_n1.weight", "layer1.0.conv2.kernel_templates.conv_1n.weight", "layer1.0.conv2.attention.fc1.weight", "layer1.0.conv2.attention.fc2.weight", "layer1.1.conv1.conv.weight", "layer1.1.conv1.kernel_templates.conv_nn.weight", "layer1.1.conv1.kernel_templates.conv_11.weight", "layer1.1.conv1.kernel_templates.conv_n1.weight", "layer1.1.conv1.kernel_templates.conv_1n.weight", "layer1.1.conv1.attention.fc1.weight", "layer1.1.conv1.attention.fc2.weight", "layer1.1.conv2.conv.weight", "layer1.1.conv2.kernel_templates.conv_nn.weight", "layer1.1.conv2.kernel_templates.conv_11.weight", "layer1.1.conv2.kernel_templates.conv_n1.weight", "layer1.1.conv2.kernel_templates.conv_1n.weight", "layer1.1.conv2.attention.fc1.weight", "layer1.1.conv2.attention.fc2.weight", "layer1.2.conv1.conv.weight", "layer1.2.conv1.kernel_templates.conv_nn.weight", "layer1.2.conv1.kernel_templates.conv_11.weight", "layer1.2.conv1.kernel_templates.conv_n1.weight", "layer1.2.conv1.kernel_templates.conv_1n.weight", "layer1.2.conv1.attention.fc1.weight", "layer1.2.conv1.attention.fc2.weight", "layer1.2.bn1.weight", "layer1.2.bn1.bias", "layer1.2.bn1.running_mean", "layer1.2.bn1.running_var", "layer1.2.conv2.conv.weight", "layer1.2.conv2.kernel_templates.conv_nn.weight", "layer1.2.conv2.kernel_templates.conv_11.weight", "layer1.2.conv2.kernel_templates.conv_n1.weight", "layer1.2.conv2.kernel_templates.conv_1n.weight", "layer1.2.conv2.attention.fc1.weight", "layer1.2.conv2.attention.fc2.weight", "layer1.2.bn2.weight", "layer1.2.bn2.bias", "layer1.2.bn2.running_mean", "layer1.2.bn2.running_var", "layer2.0.conv1.conv.weight", "layer2.0.conv1.kernel_templates.conv_nn.weight", "layer2.0.conv1.kernel_templates.conv_11.weight", "layer2.0.conv1.kernel_templates.conv_n1.weight", "layer2.0.conv1.kernel_templates.conv_1n.weight", "layer2.0.conv1.attention.fc1.weight", "layer2.0.conv1.attention.fc2.weight", "layer2.0.conv2.conv.weight", "layer2.0.conv2.kernel_templates.conv_nn.weight", "layer2.0.conv2.kernel_templates.conv_11.weight", "layer2.0.conv2.kernel_templates.conv_n1.weight", "layer2.0.conv2.kernel_templates.conv_1n.weight", "layer2.0.conv2.attention.fc1.weight", "layer2.0.conv2.attention.fc2.weight", "layer2.1.conv1.conv.weight", "layer2.1.conv1.kernel_templates.conv_nn.weight", "layer2.1.conv1.kernel_templates.conv_11.weight", "layer2.1.conv1.kernel_templates.conv_n1.weight", "layer2.1.conv1.kernel_templates.conv_1n.weight", "layer2.1.conv1.attention.fc1.weight", "layer2.1.conv1.attention.fc2.weight", "layer2.1.conv2.conv.weight", "layer2.1.conv2.kernel_templates.conv_nn.weight", "layer2.1.conv2.kernel_templates.conv_11.weight", "layer2.1.conv2.kernel_templates.conv_n1.weight", "layer2.1.conv2.kernel_templates.conv_1n.weight", "layer2.1.conv2.attention.fc1.weight", "layer2.1.conv2.attention.fc2.weight", "layer2.2.conv1.conv.weight", "layer2.2.conv1.kernel_templates.conv_nn.weight", "layer2.2.conv1.kernel_templates.conv_11.weight", "layer2.2.conv1.kernel_templates.conv_n1.weight", "layer2.2.conv1.kernel_templates.conv_1n.weight", "layer2.2.conv1.attention.fc1.weight", "layer2.2.conv1.attention.fc2.weight", "layer2.2.bn1.weight", "layer2.2.bn1.bias", "layer2.2.bn1.running_mean", "layer2.2.bn1.running_var", "layer2.2.conv2.conv.weight", "layer2.2.conv2.kernel_templates.conv_nn.weight", "layer2.2.conv2.kernel_templates.conv_11.weight", "layer2.2.conv2.kernel_templates.conv_n1.weight", "layer2.2.conv2.kernel_templates.conv_1n.weight", "layer2.2.conv2.attention.fc1.weight", "layer2.2.conv2.attention.fc2.weight", "layer2.2.bn2.weight", "layer2.2.bn2.bias", "layer2.2.bn2.running_mean", "layer2.2.bn2.running_var", "layer3.0.conv1.conv.weight", "layer3.0.conv1.kernel_templates.conv_nn.weight", "layer3.0.conv1.kernel_templates.conv_11.weight", "layer3.0.conv1.kernel_templates.conv_n1.weight", "layer3.0.conv1.kernel_templates.conv_1n.weight", "layer3.0.conv1.attention.fc1.weight", "layer3.0.conv1.attention.fc2.weight", "layer3.0.conv2.conv.weight", "layer3.0.conv2.kernel_templates.conv_nn.weight", "layer3.0.conv2.kernel_templates.conv_11.weight", "layer3.0.conv2.kernel_templates.conv_n1.weight", "layer3.0.conv2.kernel_templates.conv_1n.weight", "layer3.0.conv2.attention.fc1.weight", "layer3.0.conv2.attention.fc2.weight", "layer3.1.conv1.conv.weight", "layer3.1.conv1.kernel_templates.conv_nn.weight", "layer3.1.conv1.kernel_templates.conv_11.weight", "layer3.1.conv1.kernel_templates.conv_n1.weight", "layer3.1.conv1.kernel_templates.conv_1n.weight", "layer3.1.conv1.attention.fc1.weight", "layer3.1.conv1.attention.fc2.weight", "layer3.1.conv2.conv.weight", "layer3.1.conv2.kernel_templates.conv_nn.weight", "layer3.1.conv2.kernel_templates.conv_11.weight", "layer3.1.conv2.kernel_templates.conv_n1.weight", "layer3.1.conv2.kernel_templates.conv_1n.weight", "layer3.1.conv2.attention.fc1.weight", "layer3.1.conv2.attention.fc2.weight", "layer3.2.conv1.conv.weight", "layer3.2.conv1.kernel_templates.conv_nn.weight", "layer3.2.conv1.kernel_templates.conv_11.weight", "layer3.2.conv1.kernel_templates.conv_n1.weight", "layer3.2.conv1.kernel_templates.conv_1n.weight", "layer3.2.conv1.attention.fc1.weight", "layer3.2.conv1.attention.fc2.weight", "layer3.2.bn1.weight", "layer3.2.bn1.bias", "layer3.2.bn1.running_mean", "layer3.2.bn1.running_var", "layer3.2.conv2.conv.weight", "layer3.2.conv2.kernel_templates.conv_nn.weight", "layer3.2.conv2.kernel_templates.conv_11.weight", "layer3.2.conv2.kernel_templates.conv_n1.weight", "layer3.2.conv2.kernel_templates.conv_1n.weight", "layer3.2.conv2.attention.fc1.weight", "layer3.2.conv2.attention.fc2.weight", "layer3.2.bn2.weight", "layer3.2.bn2.bias", "layer3.2.bn2.running_mean", "layer3.2.bn2.running_var", "layer4.0.conv1.conv.weight", "layer4.0.conv1.kernel_templates.conv_nn.weight", "layer4.0.conv1.kernel_templates.conv_11.weight", "layer4.0.conv1.kernel_templates.conv_n1.weight", "layer4.0.conv1.kernel_templates.conv_1n.weight", "layer4.0.conv1.attention.fc1.weight", "layer4.0.conv1.attention.fc2.weight", "layer4.0.conv2.conv.weight", "layer4.0.conv2.kernel_templates.conv_nn.weight", "layer4.0.conv2.kernel_templates.conv_11.weight", "layer4.0.conv2.kernel_templates.conv_n1.weight", "layer4.0.conv2.kernel_templates.conv_1n.weight", "layer4.0.conv2.attention.fc1.weight", "layer4.0.conv2.attention.fc2.weight", "layer4.1.conv1.conv.weight", "layer4.1.conv1.kernel_templates.conv_nn.weight", "layer4.1.conv1.kernel_templates.conv_11.weight", "layer4.1.conv1.kernel_templates.conv_n1.weight", "layer4.1.conv1.kernel_templates.conv_1n.weight", "layer4.1.conv1.attention.fc1.weight", "layer4.1.conv1.attention.fc2.weight", "layer4.1.conv2.conv.weight", "layer4.1.conv2.kernel_templates.conv_nn.weight", "layer4.1.conv2.kernel_templates.conv_11.weight", "layer4.1.conv2.kernel_templates.conv_n1.weight", "layer4.1.conv2.kernel_templates.conv_1n.weight", "layer4.1.conv2.attention.fc1.weight", "layer4.1.conv2.attention.fc2.weight", "layer4.2.conv1.conv.weight", "layer4.2.conv1.kernel_templates.conv_nn.weight", "layer4.2.conv1.kernel_templates.conv_11.weight", "layer4.2.conv1.kernel_templates.conv_n1.weight", "layer4.2.conv1.kernel_templates.conv_1n.weight", "layer4.2.conv1.attention.fc1.weight", "layer4.2.conv1.attention.fc2.weight", "layer4.2.bn1.weight", "layer4.2.bn1.bias", "layer4.2.bn1.running_mean", "layer4.2.bn1.running_var", "layer4.2.conv2.conv.weight", "layer4.2.conv2.kernel_templates.conv_nn.weight", "layer4.2.conv2.kernel_templates.conv_11.weight", "layer4.2.conv2.kernel_templates.conv_n1.weight", "layer4.2.conv2.kernel_templates.conv_1n.weight", "layer4.2.conv2.attention.fc1.weight", "layer4.2.conv2.attention.fc2.weight", "layer4.2.bn2.weight", "layer4.2.bn2.bias", "layer4.2.bn2.running_mean", "layer4.2.bn2.running_var". 
	Unexpected key(s) in state_dict: "fc.weight", "fc.bias", "layer1.0.conv1.weight", "layer1.0.conv2.weight", "layer1.1.conv1.weight", "layer1.1.conv2.weight", "layer2.0.conv1.weight", "layer2.0.conv2.weight", "layer2.1.conv1.weight", "layer2.1.conv2.weight", "layer3.0.conv1.weight", "layer3.0.conv2.weight", "layer3.1.conv1.weight", "layer3.1.conv2.weight", "layer4.0.conv1.weight", "layer4.0.conv2.weight", "layer4.1.conv1.weight", "layer4.1.conv2.weight". 
[2024-03-11 19:46:01] [ddg.trainer.trainer:231 INFO] 
All args of DomainMix:
╒══════════════════╤════════════════════════════════════════════════════════════════════════════════════════════╕
│ Args             │ Value                                                                                      │
╞══════════════════╪════════════════════════════════════════════════════════════════════════════════════════════╡
│ root             │ /ailab_mat/dataset/DDG                                                                     │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset          │ PACS                                                                                       │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ transform        │ TransformForPACS                                                                           │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ input_size       │ 224                                                                                        │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ source_domains   │ ['Cartoon', 'Photo', 'Sketch']                                                             │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ target_domains   │ ['ArtPainting']                                                                            │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ models           │ OrderedDict([('backbone', 'resnet18_dynamic'), ('fc', 'fc')])                              │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ workers          │ 6                                                                                          │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ sampler          │ DistributedSampler                                                                         │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ epochs           │ 50                                                                                         │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ batch_size       │ 64                                                                                         │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ optimizer        │ OrderedDict([('name', 'SGD'), ('lr', 0.001), ('momentum', 0.9), ('weight_decay', 0.0005)]) │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ scheduler        │ OrderedDict([('name', 'CosineAnnealingLR')])                                               │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ label_smoothing  │ 0.0                                                                                        │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ pretrained       │ True                                                                                       │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ resume           │                                                                                            │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ checkpoint_freq  │ 10                                                                                         │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ log_freq         │ 10                                                                                         │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ evaluate         │ False                                                                                      │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ val_split        │ test                                                                                       │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ final_model      │                                                                                            │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ distributed      │ False                                                                                      │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ dist_backend     │ nccl                                                                                       │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ gpu              │ 0                                                                                          │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ seed             │                                                                                            │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_dir         │ +=/PACS_resnet18_dynamic_fc/ArtPainting/1                                                  │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ num_class        │ 7                                                                                          │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ domain_mix_type  │ crossdomain                                                                                │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ domain_mix_alpha │ 1.0                                                                                        │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ domain_mix_beta  │ 1.0                                                                                        │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ log_file         │ 03_11_19_45_56_log.txt                                                                     │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ backbone         │ {'out_features': 512}                                                                      │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│ fc               │ {}                                                                                         │
╘══════════════════╧════════════════════════════════════════════════════════════════════════════════════════════╛
